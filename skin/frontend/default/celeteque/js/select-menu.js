(function($j){var settings={combine:true,groupPageText:'All In This Category',nested:true,prependTo:'.nav-container',switchWidth:751,topOptionText:'SHOP CATEGORIES'},$jmenus,menuCount=0,uniqueLinks=[];function goTo(url){document.location.href=url;}function menuExists(){return($j('.mnav').length)?true:false;}function isList($jthis){var pass=true;$jthis.each(function(){if(!$j(this).is('ul')&&!$j(this).is('ol')){pass=false;}});return pass;}function isMobile(){return($j(window).width()<settings.switchWidth);}function getText($jitem){return $j.trim($jitem.clone().children('ul, ol').remove().end().text());}function isUrlUnique(url){return($j.inArray(url,uniqueLinks)===-1)?true:false;}function checkForDuplicates($jmenu){$jmenu.find(' > li').each(function(){var $jli=$j(this),link=$jli.find('a').attr('href'),parentLink=function(){if($jli.parent().parent().is('li')){return $jli.parent().parent().find('a').attr('href');}else{return null;}};if($jli.find(' ul, ol').length){checkForDuplicates($jli.find('> ul, > ol'));}if(!$jli.find(' > ul li, > ol li').length){$jli.find('ul, ol').remove();}if(!isUrlUnique(parentLink(),uniqueLinks)&&isUrlUnique(link,uniqueLinks)){$jli.appendTo($jmenu.closest('ul#mmnav').find('li:has(a[href='+parentLink()+']):first ul'));}else if(isUrlUnique(link)){uniqueLinks.push(link);}else{$jli.remove();}});}function combineLists(){var $jmenu=$j('<ul id="mmnav" />');$jmenus.each(function(){$j(this).children().clone().appendTo($jmenu);});checkForDuplicates($jmenu);return $jmenu;}function createOption($jitem,$jcontainer,text){if(!text){$j('<option value="'+$jitem.find('a:first').attr('href')+'">'+$j.trim(getText($jitem))+'</option>').appendTo($jcontainer);}else{$j('<option value="'+$jitem.find('a:first').attr('href')+'">'+text+'</option>').appendTo($jcontainer);}}function createOptionGroup($jgroup,$jcontainer){var $joptgroup=$j('<optgroup label="'+$j.trim(getText($jgroup))+'" />');createOption($jgroup,$joptgroup,settings.groupPageText);$jgroup.children('ul, ol').each(function(){$j(this).children('li').each(function(){createOption($j(this),$joptgroup);});});$joptgroup.appendTo($jcontainer);}function createSelect($jmenu){var $jselect=$j('<select id="mm'+menuCount+'" class="mnav" />');menuCount++;if(settings.topOptionText){createOption($j('<li>'+settings.topOptionText+'</li>'),$jselect);}$jmenu.children('li').each(function(){var $jli=$j(this);if($jli.children('ul, ol').length&&settings.nested){createOptionGroup($jli,$jselect);}else{createOption($jli,$jselect);}});$jselect.change(function(){goTo($j(this).val());}).prependTo(settings.prependTo);}function runPlugin(){if(isMobile()&&!menuExists()){if(settings.combine){var $jmenu=combineLists();createSelect($jmenu);}else{$jmenus.each(function(){createSelect($j(this));});}}if(isMobile()&&menuExists()){$j('.mnav').show();$jmenus.hide();}if(!isMobile()&&menuExists()){$j('.mnav').hide();$jmenus.show();}}$j.fn.mobileMenu=function(options){if(options){$j.extend(settings,options);}if(isList($j(this))){$jmenus=$j(this);runPlugin();$j(window).resize(function(){runPlugin();});}else{alert('mobileMenu only works with <ul>/<ol>');}};})(jQuery);